import{_ as m,r as n,o as c,c as r,a as s,b as t,d as a,w as e,e as p}from"./app-s5JIphqh.js";const o={},h={href:"http://arxiv.org/abs/1908.08113",target:"_blank",rel:"noopener noreferrer"},u=s("p",null,"⭐⭐⭐⭐",-1),g=s("p",null,"Microsoft, arXiv:1908.08113",-1),d=s("p",null,"X-SQL 与 SQLova 类似，使用 BERT style 的 PLM 来获得 representation，只是融合 NL question 和 table schema 的信息的方式不太一样，也就是在利用 BERT-style 得到的 representation 后进一步的加工方式不一样。",-1),v=s("p",null,[s("strong",null,"X-SQL 先由 BERT-style PLM 生成 question 和 schema 的 representation，然后对 schema representation 做上下文信息的进一步加强，再交由 6 个 sub-task 分别构建出 SQL 的一部分，最终得到完整的 SQL"),t("。")],-1),y=s("h2",{id:"一、x-sql",tabindex:"-1"},[s("a",{class:"header-anchor",href:"#一、x-sql"},[s("span",null,"一、X-SQL")])],-1),_=s("p",null,"整个架构包含三层：sequence encoder、context enhancing schema encoder 和 output layer。",-1),x=s("h3",{id:"_1-1-sequence-encoder-得到-plm-的-representation",tabindex:"-1"},[s("a",{class:"header-anchor",href:"#_1-1-sequence-encoder-得到-plm-的-representation"},[s("span",null,"1.1 Sequence Encoder：得到 PLM 的 representation")])],-1),b=s("p",null,"将 question 和 table headers 拼装成下面的形式（与 SQLova 的类似）：",-1),k=s("img",{src:"https://notebook-img-1304596351.cos.ap-beijing.myqcloud.com/img/20240524204838.png",alt:"20240524204838",style:{zoom:"75%"}},null,-1),w=p('<ul><li>有一个特殊的空 column 被附加到每个 table schema 最后，也就是实际最后一个 column 后面会在加一个 <code>[EMPTY]</code></li><li>将 <code>[CLS]</code> 重命名为 <code>[CTX]</code>，用来强调这里是捕获上下文信息，而非用于下游任务的 representation</li><li>SQLova 中的 segment embeddings 被替换为 type embeddings，这是我们为四种 types 学习的 embeddings：question、categorial column、numerical column 和 special empty column</li></ul><p>另外，这里的 PLM 不是使用 BERT-Large 初始化的，而是使用 MT-DNN 初始化的，它与 BERT 架构相同，只是在多个 GLUE 任务上做过训练，从而能够得到更好的用于下游任务的 representation。</p><p>经过这一层，我们为 question 和 table schema 的每个 token 都利用 BERT-style PLM 生成一个 hidden state。</p><h3 id="_1-2-context-enhanced-schema-encoder-加强-schema-representation" tabindex="-1"><a class="header-anchor" href="#_1-2-context-enhanced-schema-encoder-加强-schema-representation"><span>1.2 Context Enhanced Schema Encoder：加强 schema representation</span></a></h3>',4),z=s("p",null,[t("在上一层 seq encoder 中，我们为 question 和 table headers 的每个 token 都得到一个 hidden state vector，在这一层，我们的 context enchanced schema encoder 通过用 "),s("span",{class:"katex"},[s("span",{class:"katex-mathml"},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("semantics",null,[s("mrow",null,[s("msub",null,[s("mi",null,"h"),s("mrow",null,[s("mo",{stretchy:"false"},"["),s("mi",null,"C"),s("mi",null,"T"),s("mi",null,"X"),s("mo",{stretchy:"false"},"]")])])]),s("annotation",{encoding:"application/x-tex"},"h_{[CTX]}")])])]),s("span",{class:"katex-html","aria-hidden":"true"},[s("span",{class:"base"},[s("span",{class:"strut",style:{height:"1.0496em","vertical-align":"-0.3552em"}}),s("span",{class:"mord"},[s("span",{class:"mord mathnormal"},"h"),s("span",{class:"msupsub"},[s("span",{class:"vlist-t vlist-t2"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.3448em"}},[s("span",{style:{top:"-2.5198em","margin-left":"0em","margin-right":"0.05em"}},[s("span",{class:"pstrut",style:{height:"2.7em"}}),s("span",{class:"sizing reset-size6 size3 mtight"},[s("span",{class:"mord mtight"},[s("span",{class:"mopen mtight"},"["),s("span",{class:"mord mathnormal mtight",style:{"margin-right":"0.07847em"}},"CTX"),s("span",{class:"mclose mtight"},"]")])])])]),s("span",{class:"vlist-s"},"​")]),s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.3552em"}},[s("span")])])])])])])])]),t(" 来加强前面 encoder 的输出，从而得到每个 column 的一个新的 representation "),s("span",{class:"katex"},[s("span",{class:"katex-mathml"},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("semantics",null,[s("mrow",null,[s("msub",null,[s("mi",null,"h"),s("msub",null,[s("mi",null,"C"),s("mi",null,"i")])])]),s("annotation",{encoding:"application/x-tex"},"h_{C_i}")])])]),s("span",{class:"katex-html","aria-hidden":"true"},[s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.9445em","vertical-align":"-0.2501em"}}),s("span",{class:"mord"},[s("span",{class:"mord mathnormal"},"h"),s("span",{class:"msupsub"},[s("span",{class:"vlist-t vlist-t2"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.3283em"}},[s("span",{style:{top:"-2.55em","margin-left":"0em","margin-right":"0.05em"}},[s("span",{class:"pstrut",style:{height:"2.7em"}}),s("span",{class:"sizing reset-size6 size3 mtight"},[s("span",{class:"mord mtight"},[s("span",{class:"mord mtight"},[s("span",{class:"mord mathnormal mtight",style:{"margin-right":"0.07153em"}},"C"),s("span",{class:"msupsub"},[s("span",{class:"vlist-t vlist-t2"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.3281em"}},[s("span",{style:{top:"-2.357em","margin-left":"-0.0715em","margin-right":"0.0714em"}},[s("span",{class:"pstrut",style:{height:"2.5em"}}),s("span",{class:"sizing reset-size3 size1 mtight"},[s("span",{class:"mord mathnormal mtight"},"i")])])]),s("span",{class:"vlist-s"},"​")]),s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.143em"}},[s("span")])])])])])])])])]),s("span",{class:"vlist-s"},"​")]),s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.2501em"}},[s("span")])])])])])])])]),t("，它代表 column "),s("em",null,"i"),t(" 的新 representation。")],-1),f=s("p",null,[t("论文认为，尽管 BERT style 的 sequence encoder 在它的 output 中也捕捉到了一定的 context，但是这种 context influence 受限于 self-attention 的机制（它倾向于关注某个特定 region 从而缺少全局信息），所以这里使用带有全局信息的 "),s("code",null,"[CTX]"),t(" 的 hidden state 来加强 representation。")],-1),L=s("p",null,[t("这里的具体做法就是，将 column "),s("em",null,"i"),t(" 的所有 token 的 hidden state 和 "),s("span",{class:"katex"},[s("span",{class:"katex-mathml"},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("semantics",null,[s("mrow",null,[s("msub",null,[s("mi",null,"h"),s("mrow",null,[s("mo",{stretchy:"false"},"["),s("mi",null,"C"),s("mi",null,"T"),s("mi",null,"X"),s("mo",{stretchy:"false"},"]")])])]),s("annotation",{encoding:"application/x-tex"},"h_{[CTX]}")])])]),s("span",{class:"katex-html","aria-hidden":"true"},[s("span",{class:"base"},[s("span",{class:"strut",style:{height:"1.0496em","vertical-align":"-0.3552em"}}),s("span",{class:"mord"},[s("span",{class:"mord mathnormal"},"h"),s("span",{class:"msupsub"},[s("span",{class:"vlist-t vlist-t2"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.3448em"}},[s("span",{style:{top:"-2.5198em","margin-left":"0em","margin-right":"0.05em"}},[s("span",{class:"pstrut",style:{height:"2.7em"}}),s("span",{class:"sizing reset-size6 size3 mtight"},[s("span",{class:"mord mtight"},[s("span",{class:"mopen mtight"},"["),s("span",{class:"mord mathnormal mtight",style:{"margin-right":"0.07847em"}},"CTX"),s("span",{class:"mclose mtight"},"]")])])])]),s("span",{class:"vlist-s"},"​")]),s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.3552em"}},[s("span")])])])])])])])]),t(" 一起输入到一个 Attention 层中，得到加强后的新的 column "),s("span",{class:"katex"},[s("span",{class:"katex-mathml"},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("semantics",null,[s("mrow",null,[s("mi",null,"i")]),s("annotation",{encoding:"application/x-tex"},"i")])])]),s("span",{class:"katex-html","aria-hidden":"true"},[s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.6595em"}}),s("span",{class:"mord mathnormal"},"i")])])]),t(" 的 representation：")],-1),M=s("img",{src:"https://notebook-img-1304596351.cos.ap-beijing.myqcloud.com/img/20240524210700.png",alt:"20240524210700",style:{zoom:"75%"}},null,-1),C=s("p",null,[s("strong",null,"经过这一层 encoder，我们得到了上下文增强的 schema representation，也就是每个 column 的新 representation"),t("。")],-1),S=s("p",null,'这一步的做法也体现出 X-SQL 与 SQLova 的区别，这一层的 "context enchanced schema encoder" 和 SQLova 中引入的 column-attention 机制都是为了相同的目标：更好地对齐 question 和 table schema，但两者的实现思路却不同：',-1),q=s("ul",null,[s("li",null,"column-attention 通过将 column 作为条件来改变 question 的编码"),s("li",null,[t("context enchanced schema encoder 认为 BERT-style 的 encoder 已经足够好了，只是基于此并试图使用 "),s("code",null,"[CTX]"),t(" 中捕获的全局上下文信息来得到一个更好的 representation。")])],-1),T=s("h3",{id:"_1-3-output-layer-完成各-sub-task-生成-sql",tabindex:"-1"},[s("a",{class:"header-anchor",href:"#_1-3-output-layer-完成各-sub-task-生成-sql"},[s("span",null,"1.3 Output Layer：完成各 sub-task 生成 SQL")])],-1),E=s("p",null,[t("这一层借助 sequence encoder 输出的 hidden states 和 context enchanced schema encoder 输出的 "),s("span",{class:"katex"},[s("span",{class:"katex-mathml"},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("semantics",null,[s("mrow",null,[s("msub",null,[s("mi",null,"h"),s("msub",null,[s("mi",null,"C"),s("mn",null,"1")])])]),s("annotation",{encoding:"application/x-tex"},"h_{C_1}")])])]),s("span",{class:"katex-html","aria-hidden":"true"},[s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.9445em","vertical-align":"-0.2501em"}}),s("span",{class:"mord"},[s("span",{class:"mord mathnormal"},"h"),s("span",{class:"msupsub"},[s("span",{class:"vlist-t vlist-t2"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.3283em"}},[s("span",{style:{top:"-2.55em","margin-left":"0em","margin-right":"0.05em"}},[s("span",{class:"pstrut",style:{height:"2.7em"}}),s("span",{class:"sizing reset-size6 size3 mtight"},[s("span",{class:"mord mtight"},[s("span",{class:"mord mtight"},[s("span",{class:"mord mathnormal mtight",style:{"margin-right":"0.07153em"}},"C"),s("span",{class:"msupsub"},[s("span",{class:"vlist-t vlist-t2"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.3173em"}},[s("span",{style:{top:"-2.357em","margin-left":"-0.0715em","margin-right":"0.0714em"}},[s("span",{class:"pstrut",style:{height:"2.5em"}}),s("span",{class:"sizing reset-size3 size1 mtight"},[s("span",{class:"mord mtight"},"1")])])]),s("span",{class:"vlist-s"},"​")]),s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.143em"}},[s("span")])])])])])])])])]),s("span",{class:"vlist-s"},"​")]),s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.2501em"}},[s("span")])])])])])])])]),t("、"),s("span",{class:"katex"},[s("span",{class:"katex-mathml"},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("semantics",null,[s("mrow",null,[s("msub",null,[s("mi",null,"h"),s("msub",null,[s("mi",null,"C"),s("mn",null,"2")])])]),s("annotation",{encoding:"application/x-tex"},"h_{C_2}")])])]),s("span",{class:"katex-html","aria-hidden":"true"},[s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.9445em","vertical-align":"-0.2501em"}}),s("span",{class:"mord"},[s("span",{class:"mord mathnormal"},"h"),s("span",{class:"msupsub"},[s("span",{class:"vlist-t vlist-t2"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.3283em"}},[s("span",{style:{top:"-2.55em","margin-left":"0em","margin-right":"0.05em"}},[s("span",{class:"pstrut",style:{height:"2.7em"}}),s("span",{class:"sizing reset-size6 size3 mtight"},[s("span",{class:"mord mtight"},[s("span",{class:"mord mtight"},[s("span",{class:"mord mathnormal mtight",style:{"margin-right":"0.07153em"}},"C"),s("span",{class:"msupsub"},[s("span",{class:"vlist-t vlist-t2"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.3173em"}},[s("span",{style:{top:"-2.357em","margin-left":"-0.0715em","margin-right":"0.0714em"}},[s("span",{class:"pstrut",style:{height:"2.5em"}}),s("span",{class:"sizing reset-size3 size1 mtight"},[s("span",{class:"mord mtight"},"2")])])]),s("span",{class:"vlist-s"},"​")]),s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.143em"}},[s("span")])])])])])])])])]),s("span",{class:"vlist-s"},"​")]),s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.2501em"}},[s("span")])])])])])])])]),t("、...、"),s("span",{class:"katex"},[s("span",{class:"katex-mathml"},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("semantics",null,[s("mrow",null,[s("msub",null,[s("mi",null,"h"),s("mrow",null,[s("mo",{stretchy:"false"},"["),s("mi",null,"E"),s("mi",null,"M"),s("mi",null,"P"),s("mi",null,"T"),s("mi",null,"Y"),s("mo",{stretchy:"false"},"]")])])]),s("annotation",{encoding:"application/x-tex"},"h_{[EMPTY]}")])])]),s("span",{class:"katex-html","aria-hidden":"true"},[s("span",{class:"base"},[s("span",{class:"strut",style:{height:"1.0496em","vertical-align":"-0.3552em"}}),s("span",{class:"mord"},[s("span",{class:"mord mathnormal"},"h"),s("span",{class:"msupsub"},[s("span",{class:"vlist-t vlist-t2"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.3448em"}},[s("span",{style:{top:"-2.5198em","margin-left":"0em","margin-right":"0.05em"}},[s("span",{class:"pstrut",style:{height:"2.7em"}}),s("span",{class:"sizing reset-size6 size3 mtight"},[s("span",{class:"mord mtight"},[s("span",{class:"mopen mtight"},"["),s("span",{class:"mord mathnormal mtight",style:{"margin-right":"0.13889em"}},"EMPT"),s("span",{class:"mord mathnormal mtight",style:{"margin-right":"0.22222em"}},"Y"),s("span",{class:"mclose mtight"},"]")])])])]),s("span",{class:"vlist-s"},"​")]),s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.3552em"}},[s("span")])])])])])])])]),t(" 来生成 SQL。这里的思路也是基于 SQL sketch 并填充 slots。")],-1),Q=s("p",null,"这一步的任务被分解成了 6 个子任务，每个子任务预测最终 SQL 程序的一部分。",-1),X=s("h4",{id:"_1-3-1-用来修正-schema-representation-的-sub-network",tabindex:"-1"},[s("a",{class:"header-anchor",href:"#_1-3-1-用来修正-schema-representation-的-sub-network"},[s("span",null,"1.3.1 用来修正 schema representation 的 sub-network")])],-1),P=s("p",null,[t("首先，这里引入了一个 sub-network 用来调整 schema representation with context，具体来说，就是分别对 "),s("span",{class:"katex"},[s("span",{class:"katex-mathml"},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("semantics",null,[s("mrow",null,[s("msub",null,[s("mi",null,"H"),s("mrow",null,[s("mo",{stretchy:"false"},"["),s("mi",null,"C"),s("mi",null,"T"),s("mi",null,"X"),s("mo",{stretchy:"false"},"]")])])]),s("annotation",{encoding:"application/x-tex"},"H_{[CTX]}")])])]),s("span",{class:"katex-html","aria-hidden":"true"},[s("span",{class:"base"},[s("span",{class:"strut",style:{height:"1.0385em","vertical-align":"-0.3552em"}}),s("span",{class:"mord"},[s("span",{class:"mord mathnormal",style:{"margin-right":"0.08125em"}},"H"),s("span",{class:"msupsub"},[s("span",{class:"vlist-t vlist-t2"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.3448em"}},[s("span",{style:{top:"-2.5198em","margin-left":"-0.0813em","margin-right":"0.05em"}},[s("span",{class:"pstrut",style:{height:"2.7em"}}),s("span",{class:"sizing reset-size6 size3 mtight"},[s("span",{class:"mord mtight"},[s("span",{class:"mopen mtight"},"["),s("span",{class:"mord mathnormal mtight",style:{"margin-right":"0.07847em"}},"CTX"),s("span",{class:"mclose mtight"},"]")])])])]),s("span",{class:"vlist-s"},"​")]),s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.3552em"}},[s("span")])])])])])])])]),t(" 和 "),s("span",{class:"katex"},[s("span",{class:"katex-mathml"},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("semantics",null,[s("mrow",null,[s("msub",null,[s("mi",null,"H"),s("msub",null,[s("mi",null,"C"),s("mi",null,"i")])])]),s("annotation",{encoding:"application/x-tex"},"H_{C_i}")])])]),s("span",{class:"katex-html","aria-hidden":"true"},[s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.9334em","vertical-align":"-0.2501em"}}),s("span",{class:"mord"},[s("span",{class:"mord mathnormal",style:{"margin-right":"0.08125em"}},"H"),s("span",{class:"msupsub"},[s("span",{class:"vlist-t vlist-t2"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.3283em"}},[s("span",{style:{top:"-2.55em","margin-left":"-0.0813em","margin-right":"0.05em"}},[s("span",{class:"pstrut",style:{height:"2.7em"}}),s("span",{class:"sizing reset-size6 size3 mtight"},[s("span",{class:"mord mtight"},[s("span",{class:"mord mtight"},[s("span",{class:"mord mathnormal mtight",style:{"margin-right":"0.07153em"}},"C"),s("span",{class:"msupsub"},[s("span",{class:"vlist-t vlist-t2"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.3281em"}},[s("span",{style:{top:"-2.357em","margin-left":"-0.0715em","margin-right":"0.0714em"}},[s("span",{class:"pstrut",style:{height:"2.5em"}}),s("span",{class:"sizing reset-size3 size1 mtight"},[s("span",{class:"mord mathnormal mtight"},"i")])])]),s("span",{class:"vlist-s"},"​")]),s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.143em"}},[s("span")])])])])])])])])]),s("span",{class:"vlist-s"},"​")]),s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.2501em"}},[s("span")])])])])])])])]),t(" 做一个仿射变换，再加起来经过一个 LayerNorm 得到 "),s("span",{class:"katex"},[s("span",{class:"katex-mathml"},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("semantics",null,[s("mrow",null,[s("msub",null,[s("mi",null,"r"),s("msub",null,[s("mi",null,"C"),s("mi",null,"i")])])]),s("annotation",{encoding:"application/x-tex"},"r_{C_i}")])])]),s("span",{class:"katex-html","aria-hidden":"true"},[s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.6807em","vertical-align":"-0.2501em"}}),s("span",{class:"mord"},[s("span",{class:"mord mathnormal",style:{"margin-right":"0.02778em"}},"r"),s("span",{class:"msupsub"},[s("span",{class:"vlist-t vlist-t2"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.3283em"}},[s("span",{style:{top:"-2.55em","margin-left":"-0.0278em","margin-right":"0.05em"}},[s("span",{class:"pstrut",style:{height:"2.7em"}}),s("span",{class:"sizing reset-size6 size3 mtight"},[s("span",{class:"mord mtight"},[s("span",{class:"mord mtight"},[s("span",{class:"mord mathnormal mtight",style:{"margin-right":"0.07153em"}},"C"),s("span",{class:"msupsub"},[s("span",{class:"vlist-t vlist-t2"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.3281em"}},[s("span",{style:{top:"-2.357em","margin-left":"-0.0715em","margin-right":"0.0714em"}},[s("span",{class:"pstrut",style:{height:"2.5em"}}),s("span",{class:"sizing reset-size3 size1 mtight"},[s("span",{class:"mord mathnormal mtight"},"i")])])]),s("span",{class:"vlist-s"},"​")]),s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.143em"}},[s("span")])])])])])])])])]),s("span",{class:"vlist-s"},"​")]),s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.2501em"}},[s("span")])])])])])])])]),t("（column "),s("em",null,"i"),t(" 一个修正后的 representation），图示如下：")],-1),B=s("img",{src:"https://notebook-img-1304596351.cos.ap-beijing.myqcloud.com/img/20240524213837.png",alt:"20240524213837",style:{zoom:"75%"}},null,-1),N=s("p",null,"公式如下：",-1),R=s("img",{src:"https://notebook-img-1304596351.cos.ap-beijing.myqcloud.com/img/20240524213850.png",alt:"20240524213850",style:{zoom:"75%"}},null,-1),j=s("p",null,[t("注意，这个 sub-network 在每个 sub-task 中都是独立训练的，也就是每个 sub-task 得到的 "),s("span",{class:"katex"},[s("span",{class:"katex-mathml"},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("semantics",null,[s("mrow",null,[s("msub",null,[s("mi",null,"r"),s("msub",null,[s("mi",null,"C"),s("mi",null,"i")])])]),s("annotation",{encoding:"application/x-tex"},"r_{C_i}")])])]),s("span",{class:"katex-html","aria-hidden":"true"},[s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.6807em","vertical-align":"-0.2501em"}}),s("span",{class:"mord"},[s("span",{class:"mord mathnormal",style:{"margin-right":"0.02778em"}},"r"),s("span",{class:"msupsub"},[s("span",{class:"vlist-t vlist-t2"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.3283em"}},[s("span",{style:{top:"-2.55em","margin-left":"-0.0278em","margin-right":"0.05em"}},[s("span",{class:"pstrut",style:{height:"2.7em"}}),s("span",{class:"sizing reset-size6 size3 mtight"},[s("span",{class:"mord mtight"},[s("span",{class:"mord mtight"},[s("span",{class:"mord mathnormal mtight",style:{"margin-right":"0.07153em"}},"C"),s("span",{class:"msupsub"},[s("span",{class:"vlist-t vlist-t2"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.3281em"}},[s("span",{style:{top:"-2.357em","margin-left":"-0.0715em","margin-right":"0.0714em"}},[s("span",{class:"pstrut",style:{height:"2.5em"}}),s("span",{class:"sizing reset-size3 size1 mtight"},[s("span",{class:"mord mathnormal mtight"},"i")])])]),s("span",{class:"vlist-s"},"​")]),s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.143em"}},[s("span")])])])])])])])])]),s("span",{class:"vlist-s"},"​")]),s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.2501em"}},[s("span")])])])])])])])]),t(" 是不同的，"),s("strong",null,"这也体现了这个 sub-network 就是针对一个具体 task 来修正 schema representation"),t("。")],-1),H=s("p",null,[t("之后，各个 sub-task 就可以基于我们之前得到的 vectors 和 "),s("span",{class:"katex"},[s("span",{class:"katex-mathml"},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("semantics",null,[s("mrow",null,[s("msub",null,[s("mi",null,"r"),s("msub",null,[s("mi",null,"C"),s("mi",null,"i")])])]),s("annotation",{encoding:"application/x-tex"},"r_{C_i}")])])]),s("span",{class:"katex-html","aria-hidden":"true"},[s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.6807em","vertical-align":"-0.2501em"}}),s("span",{class:"mord"},[s("span",{class:"mord mathnormal",style:{"margin-right":"0.02778em"}},"r"),s("span",{class:"msupsub"},[s("span",{class:"vlist-t vlist-t2"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.3283em"}},[s("span",{style:{top:"-2.55em","margin-left":"-0.0278em","margin-right":"0.05em"}},[s("span",{class:"pstrut",style:{height:"2.7em"}}),s("span",{class:"sizing reset-size6 size3 mtight"},[s("span",{class:"mord mtight"},[s("span",{class:"mord mtight"},[s("span",{class:"mord mathnormal mtight",style:{"margin-right":"0.07153em"}},"C"),s("span",{class:"msupsub"},[s("span",{class:"vlist-t vlist-t2"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.3281em"}},[s("span",{style:{top:"-2.357em","margin-left":"-0.0715em","margin-right":"0.0714em"}},[s("span",{class:"pstrut",style:{height:"2.5em"}}),s("span",{class:"sizing reset-size3 size1 mtight"},[s("span",{class:"mord mathnormal mtight"},"i")])])]),s("span",{class:"vlist-s"},"​")]),s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.143em"}},[s("span")])])])])])])])])]),s("span",{class:"vlist-s"},"​")]),s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.2501em"}},[s("span")])])])])])])])]),t(" 来做了。")],-1),W=s("h4",{id:"_1-3-2-sub-task-1-s-col",tabindex:"-1"},[s("a",{class:"header-anchor",href:"#_1-3-2-sub-task-1-s-col"},[s("span",null,"1.3.2 sub-task 1：S-COL")])],-1),O=s("p",null,"S-COL 任务是预测 SELECT 语句中的 columns，这其实就是计算各个 columns 的一个概率，计算方式如下：",-1),Y=s("img",{src:"https://notebook-img-1304596351.cos.ap-beijing.myqcloud.com/img/20240524214322.png",alt:"20240524214322",style:{zoom:"75%"}},null,-1),I=s("p",null,[t("可以看到，这里只使用了 "),s("span",{class:"katex"},[s("span",{class:"katex-mathml"},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("semantics",null,[s("mrow",null,[s("msub",null,[s("mi",null,"r"),s("msub",null,[s("mi",null,"C"),s("mi",null,"i")])])]),s("annotation",{encoding:"application/x-tex"},"r_{C_i}")])])]),s("span",{class:"katex-html","aria-hidden":"true"},[s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.6807em","vertical-align":"-0.2501em"}}),s("span",{class:"mord"},[s("span",{class:"mord mathnormal",style:{"margin-right":"0.02778em"}},"r"),s("span",{class:"msupsub"},[s("span",{class:"vlist-t vlist-t2"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.3283em"}},[s("span",{style:{top:"-2.55em","margin-left":"-0.0278em","margin-right":"0.05em"}},[s("span",{class:"pstrut",style:{height:"2.7em"}}),s("span",{class:"sizing reset-size6 size3 mtight"},[s("span",{class:"mord mtight"},[s("span",{class:"mord mtight"},[s("span",{class:"mord mathnormal mtight",style:{"margin-right":"0.07153em"}},"C"),s("span",{class:"msupsub"},[s("span",{class:"vlist-t vlist-t2"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.3281em"}},[s("span",{style:{top:"-2.357em","margin-left":"-0.0715em","margin-right":"0.0714em"}},[s("span",{class:"pstrut",style:{height:"2.5em"}}),s("span",{class:"sizing reset-size3 size1 mtight"},[s("span",{class:"mord mathnormal mtight"},"i")])])]),s("span",{class:"vlist-s"},"​")]),s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.143em"}},[s("span")])])])])])])])])]),s("span",{class:"vlist-s"},"​")]),s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.2501em"}},[s("span")])])])])])])])]),t("，另外的 "),s("span",{class:"katex"},[s("span",{class:"katex-mathml"},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("semantics",null,[s("mrow",null,[s("mi",null,"W")]),s("annotation",{encoding:"application/x-tex"},"W")])])]),s("span",{class:"katex-html","aria-hidden":"true"},[s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.6833em"}}),s("span",{class:"mord mathnormal",style:{"margin-right":"0.13889em"}},"W")])])]),t(" 是一个可训练参数。")],-1),V=s("h4",{id:"_1-3-3-sub-task-2-s-agg",tabindex:"-1"},[s("a",{class:"header-anchor",href:"#_1-3-3-sub-task-2-s-agg"},[s("span",null,"1.3.3 sub-task 2：S-AGG")])],-1),G=s("p",null,[t("直觉来说，aggregator 的选择会依赖所选中的 column 的类型，比如 aggregator "),s("code",null,"MIN"),t(" 只能被用于数字类型的 column。为了实现这个直觉，这个 task 在做 aggregator 分类时，会利用到 column type 的 embedding：")],-1),A=s("img",{src:"https://notebook-img-1304596351.cos.ap-beijing.myqcloud.com/img/20240524214556.png",alt:"20240524214556",style:{zoom:"75%"}},null,-1),D=s("p",null,"具体公式可以参考原论文",-1),J=s("h4",{id:"_1-3-4-其他-sub-task",tabindex:"-1"},[s("a",{class:"header-anchor",href:"#_1-3-4-其他-sub-task"},[s("span",null,"1.3.4 其他 sub-task")])],-1),U=s("p",null,"其他 sub-task 共同确定出 WHERE 部分，这里可以具体参考原论文，整体思路是差不多的。",-1),F=s("h2",{id:"二、总结",tabindex:"-1"},[s("a",{class:"header-anchor",href:"#二、总结"},[s("span",null,"二、总结")])],-1),K=s("p",null,"通过以上改进，X-SQL 在表现 WikiSQL 上的表现提升到 90% 以上，超过了 SQLova：",-1),Z=s("img",{src:"https://notebook-img-1304596351.cos.ap-beijing.myqcloud.com/img/20240524215025.png",alt:"20240524215025",style:{zoom:"75%"}},null,-1),$=s("p",null,"本文对 BERT-style 生成的 representation 的进一步的加工利用值得研究学习。",-1);function ss(ts,as){const i=n("ExternalLinkIcon"),l=n("center");return c(),r("div",null,[s("blockquote",null,[s("p",null,[t("论文："),s("a",h,[t("X-SQL: reinforce schema representation with context"),a(i)])]),u,g]),d,v,y,_,x,b,a(l,null,{default:e(()=>[k]),_:1}),w,z,f,L,a(l,null,{default:e(()=>[M]),_:1}),C,S,q,T,E,Q,X,P,a(l,null,{default:e(()=>[B]),_:1}),N,a(l,null,{default:e(()=>[R]),_:1}),j,H,W,O,a(l,null,{default:e(()=>[Y]),_:1}),I,V,G,a(l,null,{default:e(()=>[A]),_:1}),D,J,U,F,K,a(l,null,{default:e(()=>[Z]),_:1}),$])}const es=m(o,[["render",ss],["__file","index.html.vue"]]),ns=JSON.parse(`{"path":"/arxiv/1908.08113/","title":"🐋 经典论文：X-SQL","lang":"zh-CN","frontmatter":{"title":"🐋 经典论文：X-SQL","author":"Bin Yu","createTime":"2024/05/24 16:44:00","permalink":"/arxiv/1908.08113/","head":[["script",{"id":"check-dark-mode"},";(function () {const um= localStorage.getItem('vuepress-theme-appearance') || 'auto';const sm = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;if (um === 'dark' || (um !== 'light' && sm)) {document.documentElement.classList.add('dark');}})();"],["script",{"id":"check-mac-os"},"document.documentElement.classList.toggle('mac', /Mac|iPhone|iPod|iPad/i.test(navigator.platform))"]]},"headers":[{"level":2,"title":"一、X-SQL","slug":"一、x-sql","link":"#一、x-sql","children":[{"level":3,"title":"1.1 Sequence Encoder：得到 PLM 的 representation","slug":"_1-1-sequence-encoder-得到-plm-的-representation","link":"#_1-1-sequence-encoder-得到-plm-的-representation","children":[]},{"level":3,"title":"1.2 Context Enhanced Schema Encoder：加强 schema representation","slug":"_1-2-context-enhanced-schema-encoder-加强-schema-representation","link":"#_1-2-context-enhanced-schema-encoder-加强-schema-representation","children":[]},{"level":3,"title":"1.3 Output Layer：完成各 sub-task 生成 SQL","slug":"_1-3-output-layer-完成各-sub-task-生成-sql","link":"#_1-3-output-layer-完成各-sub-task-生成-sql","children":[]}]},{"level":2,"title":"二、总结","slug":"二、总结","link":"#二、总结","children":[]}],"readingTime":{"minutes":4.41,"words":1324},"git":{"updatedTime":1717830098000,"contributors":[{"name":"yubinCloud","email":"yubin_SkyWalker@yeah.net","commits":2}]},"filePathRelative":"notes/Text2SQL/1908.X-SQL.md","categoryList":[{"type":10000,"name":"notes"},{"type":10004,"name":"Text2SQL"}]}`);export{es as comp,ns as data};
