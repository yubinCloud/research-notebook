---
title: ğŸ’§ SeaDï¼šä½¿ç”¨ Schema-aware å»å™ªè®­ç»ƒçš„ end2end çš„ Text2SQL
author: Bin Yu
createTime: 2024/05/26 10:51:00
permalink: /arxiv/2105.07911/
---

> è®ºæ–‡ï¼š[SeaD: End-to-end Text-to-SQL Generation with Schema-aware Denoising](https://aclanthology.org/2022.findings-naacl.141)
>
> â­â­
>
> NAACL 2022, arXiv:2105.07911

æœ¬è®ºæ–‡æå‡º SeaD æ¨¡å‹ï¼Œä½¿ç”¨ schema-aware çš„å»å™ªæ–¹æ³•æ¥è®­ç»ƒä¸€ä¸ª end2endã€seq2seq çš„ Transformer æ¨¡å‹æ¥å®ç° Text2SQLã€‚

## ä¸€ã€è®ºæ–‡é€Ÿè¯»

ç»™å®šä¸€ä¸ª question $Q$ å’Œä¸€ä¸ª schema $S$ï¼Œæˆ‘ä»¬æœŸæœ›ç”Ÿæˆç›¸åº”çš„ SQL æŸ¥è¯¢ $Y$ã€‚

### 1.1 model çš„è¾“å…¥è¾“å‡º

SeaD çš„è¾“å…¥è¾“å‡ºå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š

<center><img src="https://notebook-img-1304596351.cos.ap-beijing.myqcloud.com/img/20240526110211.png" alt="20240526110211" style="zoom:75%;"></center>

åœ¨ input ä¸­ï¼Œå°† table headers çš„å„ä¸ª column name å‰é¢åŠ ä¸€ä¸ª `<col n>` è¡¨ç¤ºç¬¬å‡ ä¸ª columnï¼Œç„¶åè·Ÿç€ column name å’Œ typeï¼Œæ¯”å¦‚å¯¹äº week å­—æ®µï¼Œå°±æ˜¯ `<col0>week:int`ã€‚

åœ¨æœŸå¾…çš„ output ä¸­ï¼ŒSQL çš„ column name ä½¿ç”¨ "\`" è¿™ä¸ª token å›´ç»•ï¼Œå¹¶å°† name æ¢ä¸ºåˆ†éš”ç¬¦ `<col n>`ï¼Œå¦‚ä¸Šå›¾æ‰€ç¤ºã€‚

### 1.2 Transformer with Pointer

è¯¥å·¥ä½œä½¿ç”¨ Transformer ä½œä¸º backbone æ¥åš seq2seq ä»»åŠ¡ã€‚

**ä¸ºä»€ä¹ˆä½¿ç”¨ Transformer with Pointer**ï¼Ÿåœ¨ Text2SQL ä»»åŠ¡ä¸­ï¼Œå¤§å¤šæ•°çš„ schema å’Œ value mentions å¯ä»¥ä» input seq ä¸­æŠ½å–å‡ºæ¥ï¼Œæ‰€ä»¥åœ¨ Transformer æ¶æ„çš„æœ€ä¸Šé¢åŠ äº†ä¸€ä¸ª Hybrid Pointer Generator Network æ¥ç”Ÿæˆ tokenï¼Œç”Ÿæˆçš„ token æ¥è‡ªäº target vocabulary $V$ æˆ–è€… copy from the input textã€‚

target vocabulary $V$ ç”±ä¸‰ä¸ªé›†åˆç»„åˆè€Œæˆï¼š

- $V_q$ è¡¨ç¤º corpora token vocabulary
- $V_c$ è¡¨ç¤º column token set
- $V_s$ è¡¨ç¤ºå¯ç”¨çš„ SQL keywords

Transformer with Pointer çš„å…·ä½“æ€è·¯å¯ä»¥å‚è€ƒåŸè®ºæ–‡ï¼Œè¿™é‡Œåšä¸€ä¸ªæ¦‚è¿°ï¼šä½¿ç”¨ Transformer ä¸­ decoder ç”Ÿæˆçš„ $h_{dec}$ è®¡ç®—å‡º target vocabulary $V$ ä¸­å„ä¸ª token çš„ unnormalized scores $scores_{v}$ å’Œ input seq ä¸­å„ä¸ª token çš„ unnormalized scores $scores_{s}$ï¼Œç„¶åå°†ä¸¤ä¸ª scores åˆå¹¶ä¸º $score_{hybrid}$ï¼Œæœ€ç»ˆè¾“å‡ºçš„æ¦‚ç‡åˆ†å¸ƒå°±æ˜¯ $P = softmax(score_{hybrid})$ã€‚

### 1.3 Schema-aware Denoising

ä¸ masted LM å’Œå…¶ä»–å»å™ªä»»åŠ¡ç±»ä¼¼ï¼Œè¿™é‡Œæå‡ºäº†ä¸¤ä¸ª schema-aware denoising çš„è®­ç»ƒæ–¹æ³•ï¼šerosion å’Œ shuffleã€‚

<center><img src="https://notebook-img-1304596351.cos.ap-beijing.myqcloud.com/img/20240526152218.png" alt="20240526152218" style="zoom:75%;"></center>

#### 1.3.1 Erosion

å‚è€ƒä¸Šå›¾ï¼Œå¯¹ table schema $S$ ä¸­çš„ column name åš erosion æ“ä½œï¼Œä¸»è¦æ˜¯åšé‡æ’ã€å¢åŠ å’Œåˆ é™¤æ“ä½œæ¥å¼•å…¥å™ªå£°ï¼ŒåŒæ—¶ `<col n>` åˆ†éš”ç¬¦ä¿æŒä¸å˜ã€‚

å¦‚æœä¸€ä¸ª column è¢«åˆ é™¤ä½†æ˜¯ç”Ÿæˆçš„ SQL éœ€è¦ä½¿ç”¨å®ƒï¼Œåˆ™ç”Ÿæˆ SQL ä¸­ä½¿ç”¨ `<unk>` æ¥æ›¿ä»£ï¼Œè¿™èƒ½è®© model å­¦ä¼šå½“ schema ä¿¡æ¯ä¸è¶³æ—¶æŠ›å‡º unknown exceptionã€‚

#### 1.3.2 Shuffle

å‚è€ƒä¸Šå›¾ï¼Œå°† source query $Q$ ä¸­çš„æåŠçš„å®ä½“ï¼ˆquestion å’Œ SQLï¼‰é‡æ–°æ’åºï¼Œè€Œ schema seq $S$ ä¿æŒä¸å˜ã€‚è¿™ä¸ª denoisiong objective è®­ç»ƒæ¨¡å‹é‡æ„å®ä½“é¡ºåºæ­£ç¡®çš„æŸ¥è¯¢åºåˆ— $Q$ã€‚

## äºŒã€æ€»ç»“

å®éªŒåœ¨ test ç»“æœä¸Šè¾¾åˆ°äº† 93 çš„å‡†ç¡®ç‡ï¼Œä½†æ²¡æœ‰å…¬å¼€ codeã€‚ä½†æœ¬æ–‡æå‡ºçš„æ€è·¯è¿˜æ˜¯å€¼å¾—å­¦ä¹ çš„ã€‚
